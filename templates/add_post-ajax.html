{% block content %}
<script>processing = true;</script>
<h1>Add post</h1>

<form action="{% url 'add_post' %}" method="post" enctype="multipart/form-data">
{% csrf_token %}

<div class="input-field">
     {{ form.title }}
     {{ form.title.label_tag }}
</div>


<div class="input-field">
    <input id="id_post_image" name="post_image" type="file"
    onchange="Preview(this.files[0], 'preview', 300)">
    {{ form.post_image.label_tag }}
    <p>
      <img id="preview"  />
    </p>
</div>


<div class="input-field">
<select id="id_category">
  {% for value, key in form.fields.category.choices %}
   <option value="{{ value }}"{% if form.initial.category == value %} selected {% endif %}>
       {{ key }}
   </option>
  {% endfor %}
</select>
{{ form.category.label_tag }}
</div>

<div class="input-field">
<p>
  <input id="id_private" name="private" type="checkbox">
   <label for="id_private">not safe for work</label>
</p>


</div>



<div class="input-field">
{{ form.description }}
{{ form.description.label_tag }}
</div>

<div class="input-field">
  {{ form.text|safe }}
  {{ form.text.label_tag }}
</div>


<div class="input-field">
  {{ form.tags_new.label_tag }}
<div>
  <div data-tags-input-name="tag" id="tagBox"></div>
</div>


</div>

<div class="input-field">
<input class="hidden_tags" id="hidden_tags" name="hidden_tags" style=" display: none;">
</div>

<div style="height: 200px"></div>

<input type="submit" value="Add Post" />
</form>

<style>

.type-zone.tt-hint {
  z-index: -1;
}

.chip > a, .tt-suggestion {
cursor: pointer;
}

.tt-selectable {
font-size: 16px;
color: #26a69a;
display: block;
line-height: 22px;
padding: 14px 16px;
background-color: white;
}

.tt-selectable:hover {
background-color: #eee;
border-color: #84c7c1;
    border-width: 1px;
    border-style: solid;;
}

</style>

<div style="height: 100px"></div>
<script>
$(document).ready(function(){
	SelectHint();

  $('select').material_select();

  froalaBanner = $('a[href="https://froala.com/wysiwyg-editor"');
  froalaBanner.hide();
  $('body').bind("DOMSubtreeModified",function(){
  $('a[href="https://froala.com/wysiwyg-editor"').hide();
  });

});



var tagging_options = {
  "no-duplicate": true,
  "no-comma": false,
	"no-duplicate-callback": HideHint,
  "forbidden-chars-callback": null,
	"tag-on-blur": false,
  "no-spacebar": true,
	"case-sensitive": true,
  //"close-char": "X",
  "close-class": "material-icons close",
  "tag-class": "chip",

  "close-char": "close",
  "forbidden-chars": [],
	"forbidden-words": [],
};

TagBox = $("#tagBox")
TagBox.tagging( tagging_options);

var taglist = new Bloodhound({
  datumTokenizer: Bloodhound.tokenizers.whitespace,
  queryTokenizer: Bloodhound.tokenizers.whitespace,
  prefetch: {
  url: '../static/taglist.json',
  cache: false
   }
});

$('.type-zone').typeahead(null, {
  name: 'taglist',
  source: taglist,
  hint: true,
  highlight: true,
  minLength: 2,
  limit: 10
});

TagBox.on( "add:after", function (el, tagging){
HintPos();
CopyTags();
TagBox.tagging( "emptyInput" );
HideHint()
} );

TagBox.on( "remove:after", function (el, tagging){
HintPos();
CopyTags();
} );

$(document).on('click', '.tt-suggestion', function() {
	HideHint()
	TagBox.tagging( "add", $(this).text() );
	TagBox.tagging( "emptyInput" );
});

</script>
{% endblock %}
